import{_ as x,c as f,o as n,w as s,b as o,a as e,f as c,a7 as d,ab as w,d as p,a6 as g,a0 as D,a8 as N,a9 as S,X as h,$ as y,a2 as _,t as u,ac as q,h as B,Q as E,e as v,ad as U,aa as I}from"./index-Df8BWSg2.js";import{Q as V}from"./QSpace-Bxp2NexB.js";import{Q,a as m,b as k}from"./QMenu-C-9qBbnL.js";import{Q as M}from"./QList-CiKTH7mx.js";import{Q as z}from"./QBtnDropdown-Dmnhfnba.js";import{Q as A}from"./QMarkupTable-D_NXUQml.js";import{Q as H}from"./QForm-DaFIjbRg.js";import{Q as K}from"./QPage-BlBGdOzc.js";import{C as b}from"./ClosePopup-S1YJxfSL.js";const L={name:"MateriasPage",data(){return{materias:[],filtro:"",loading:!1,dialog:!1,form:{id:null,nombre:"",docente:"",descripcion:""}}},mounted(){this.listar()},methods:{async listar(){this.loading=!0;try{const i=await this.$axios.get("materias",{params:{q:this.filtro||void 0}});this.materias=i.data}catch(i){this.$alert?.error?.(i.response?.data?.message||"Error al cargar materias")}finally{this.loading=!1}},nuevo(){this.form={id:null,nombre:"",docente:"",descripcion:""},this.dialog=!0},editar(i){this.form={...i,docente:i.docente||"",descripcion:i.descripcion||""},this.dialog=!0},onDialogHide(){this.form={id:null,nombre:"",docente:"",descripcion:""}},async guardar(){this.loading=!0;try{this.form.id?(await this.$axios.put(`materias/${this.form.id}`,this.form),this.$alert?.success?.("Materia actualizada")):(await this.$axios.post("materias",this.form),this.$alert?.success?.("Materia creada")),this.dialog=!1,this.listar()}catch(i){this.$alert?.error?.(i.response?.data?.message||"No se pudo guardar")}finally{this.loading=!1}},eliminar(i){this.$alert?.dialog?.("¿Eliminar registro?")?.onOk(async()=>{this.loading=!0;try{await this.$axios.delete(`materias/${i}`),this.$alert?.success?.("Eliminado"),this.listar()}catch(l){this.$alert?.error?.(l.response?.data?.message||"No se pudo eliminar")}finally{this.loading=!1}})}}},P={class:"row items-center q-gutter-sm q-mb-md"},F={class:"ellipsis"},O={key:0},T={class:"text-subtitle1"},G={class:"row q-col-gutter-sm"},R={class:"col-12 col-sm-6"},X={class:"col-12 col-sm-6"},j={class:"col-12 col-sm-6"},J={class:"col-12 col-sm-6"},W={class:"col-12"};function Y(i,l,Z,$,t,r){return n(),f(K,{class:"q-pa-md"},{default:s(()=>[o("div",P,[e(c,{color:"positive","no-caps":"",icon:"add_circle_outline",label:"Nuevo",onClick:r.nuevo,loading:t.loading},null,8,["onClick","loading"]),e(c,{color:"primary","no-caps":"",icon:"refresh",label:"Actualizar",onClick:r.listar,loading:t.loading},null,8,["onClick","loading"]),e(V),e(d,{modelValue:t.filtro,"onUpdate:modelValue":l[0]||(l[0]=a=>t.filtro=a),dense:"",outlined:"",placeholder:"Buscar... (nombre, docente, descripción)",onKeyup:w(r.listar,["enter"]),style:{"min-width":"260px"}},{append:s(()=>[e(p,{name:"search",onClick:r.listar,class:"cursor-pointer"},null,8,["onClick"])]),_:1},8,["modelValue","onKeyup"])]),e(A,{flat:"",bordered:"",dense:"","wrap-cells":""},{default:s(()=>[l[11]||(l[11]=o("thead",null,[o("tr",null,[o("th",{class:"text-left"},"Acciones"),o("th",{class:"text-left"},"ID"),o("th",{class:"text-left"},"Nombre"),o("th",{class:"text-left"},"Docente"),o("th",{class:"text-left"},"Descripción")])],-1)),o("tbody",null,[(n(!0),g(N,null,S(t.materias,a=>(n(),g("tr",{key:a.id},[o("td",null,[e(z,{label:"Opciones",size:"sm",dense:"",color:"primary","no-caps":""},{default:s(()=>[e(M,null,{default:s(()=>[h((n(),f(Q,{clickable:"",onClick:C=>r.editar(a)},{default:s(()=>[e(m,{avatar:""},{default:s(()=>[e(p,{name:"edit"})]),_:1}),e(m,null,{default:s(()=>[e(k,null,{default:s(()=>[...l[8]||(l[8]=[y("Editar",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[_],[b]]),h((n(),f(Q,{clickable:"",onClick:C=>r.eliminar(a.id)},{default:s(()=>[e(m,{avatar:""},{default:s(()=>[e(p,{name:"delete"})]),_:1}),e(m,null,{default:s(()=>[e(k,null,{default:s(()=>[...l[9]||(l[9]=[y("Eliminar",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[_],[b]])]),_:2},1024)]),_:2},1024)]),o("td",null,u(a.id),1),o("td",{style:q({backgroundColor:a.color||"transparent",color:a.color?"#fff":"inherit"})},u(a.nombre||"—"),5),o("td",null,u(a.docente||"—"),1),o("td",F,u(a.descripcion||"—"),1)]))),128)),t.materias.length?D("",!0):(n(),g("tr",O,[...l[10]||(l[10]=[o("td",{colspan:"6",class:"text-center text-grey"},"Sin datos",-1)])]))])]),_:1}),e(B,{modelValue:t.dialog,"onUpdate:modelValue":l[7]||(l[7]=a=>t.dialog=a),persistent:"",onHide:r.onDialogHide},{default:s(()=>[e(E,{style:{width:"520px","max-width":"92vw"}},{default:s(()=>[e(v,{class:"row items-center q-pb-none"},{default:s(()=>[o("div",T,u(t.form.id?"Editar materia":"Nueva materia"),1),e(V),h(e(c,{icon:"close",flat:"",round:"",dense:""},null,512),[[b]])]),_:1}),e(v,{class:"q-pt-sm"},{default:s(()=>[e(H,{onSubmit:U(r.guardar,["prevent"])},{default:s(()=>[o("div",G,[o("div",R,[e(d,{modelValue:t.form.nombre,"onUpdate:modelValue":l[1]||(l[1]=a=>t.form.nombre=a),dense:"",outlined:"",label:"Nombre"},null,8,["modelValue"])]),o("div",X,[e(d,{modelValue:t.form.docente,"onUpdate:modelValue":l[2]||(l[2]=a=>t.form.docente=a),dense:"",outlined:"",label:"Docente"},null,8,["modelValue"])]),o("div",j,[e(d,{modelValue:t.form.abreviatura,"onUpdate:modelValue":l[3]||(l[3]=a=>t.form.abreviatura=a),dense:"",outlined:"",label:"Abreviatura"},null,8,["modelValue"])]),o("div",J,[e(d,{modelValue:t.form.color,"onUpdate:modelValue":l[4]||(l[4]=a=>t.form.color=a),type:"color",dense:"",outlined:"",label:"Color"},null,8,["modelValue"])]),o("div",W,[e(d,{modelValue:t.form.descripcion,"onUpdate:modelValue":l[5]||(l[5]=a=>t.form.descripcion=a),type:"textarea",autogrow:"",dense:"",outlined:"",label:"Descripción"},null,8,["modelValue"])])])]),_:1},8,["onSubmit"])]),_:1}),e(I,{align:"right"},{default:s(()=>[e(c,{flat:"",color:"negative","no-caps":"",label:"Cancelar",onClick:l[6]||(l[6]=a=>t.dialog=!1),disable:t.loading},null,8,["disable"]),e(c,{color:"primary","no-caps":"",label:t.form.id?"Actualizar":"Guardar",onClick:r.guardar,loading:t.loading},null,8,["label","onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide"])]),_:1})}const de=x(L,[["render",Y]]);export{de as default};
